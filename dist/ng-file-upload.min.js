!window.XMLHttpRequest||window.FileAPI&&FileAPI.shouldLoad||(window.XMLHttpRequest.prototype.setRequestHeader=function(a){return function(b,c){if("__setXHR_"===b){var d=c(this);d instanceof Function&&d(this)}else a.apply(this,arguments)}}(window.XMLHttpRequest.prototype.setRequestHeader));var ngFileUpload=angular.module("ngFileUpload",[]);ngFileUpload.version="12.0.4",ngFileUpload.service("UploadBase",["$http","$q","$timeout",function(a,b,c){function f(f){function i(a){g.notify&&g.notify(a),h.progressFunc&&c(function(){h.progressFunc(a)})}function j(a){return null!=f._start&&e?{loaded:a.loaded+f._start,total:f._file&&f._file.size||a.total,type:a.type,config:f,lengthComputable:!0,target:a.target}:a}function k(){a(f).then(function(a){e&&f._chunkSize&&!f._finished&&f._file?(i({loaded:f._end,total:f._file&&f._file.size,config:f,type:"progress"}),d.upload(f,!0)):(f._finished&&delete f._finished,g.resolve(a))},function(a){g.reject(a)},function(a){g.notify(a)})}f.method=f.method||"POST",f.headers=f.headers||{};var g=f._deferred=f._deferred||b.defer(),h=g.promise;return f.disableProgress||(f.headers.__setXHR_=function(){return function(a){a&&a.upload&&a.upload.addEventListener&&(f.__XHR=a,f.xhrFn&&f.xhrFn(a),a.upload.addEventListener("progress",function(a){a.config=f,i(j(a))},!1),a.upload.addEventListener("load",function(a){a.lengthComputable&&(a.config=f,i(j(a)))},!1))}}),e?f._chunkSize&&f._end&&!f._finished?(f._start=f._end,f._end+=f._chunkSize,k()):f.resumeSizeUrl?a.get(f.resumeSizeUrl).then(function(a){f.resumeSizeResponseReader?f._start=f.resumeSizeResponseReader(a.data):f._start=parseInt((null==a.data.size?a.data:a.data.size).toString()),f._chunkSize&&(f._end=f._start+f._chunkSize),k()},function(a){throw a}):f.resumeSize?f.resumeSize().then(function(a){f._start=a,k()},function(a){throw a}):(f._chunkSize&&(f._start=0,f._end=f._start+f._chunkSize),k()):k(),h.success=function(a){return h.then(function(b){a(b.data,b.status,b.headers,f)}),h},h.error=function(a){return h.then(null,function(b){a(b.data,b.status,b.headers,f)}),h},h.progress=function(a){return h.progressFunc=a,h.then(null,null,function(b){a(b)}),h},h.abort=h.pause=function(){return f.__XHR&&c(function(){f.__XHR.abort()}),h},h.xhr=function(a){return f.xhrFn=function(b){return function(){b&&b.apply(h,arguments),a.apply(h,arguments)}}(f.xhrFn),h},d.promisesCount++,h.finally(function(){d.promisesCount--}),h}function g(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var d=this;d.promisesCount=0,this.isResumeSupported=function(){return window.Blob&&window.Blob.prototype.slice};var e=this.isResumeSupported();this.isUploadInProgress=function(){return d.promisesCount>0},this.rename=function(a,b){return a.ngfName=b,a},this.jsonBlob=function(a){null==a||angular.isString(a)||(a=JSON.stringify(a));var b=new window.Blob([a],{type:"application/json"});return b._ngfBlob=!0,b},this.json=function(a){return angular.toJson(a)},this.isFile=function(a){return null!=a&&(a instanceof window.Blob||a.flashId&&a.name&&a.size)},this.upload=function(a,b){function c(b,c){if(b._ngfBlob)return b;if(a._file=a._file||b,null!=a._start&&e){a._end&&a._end>=b.size&&(a._finished=!0,a._end=b.size);var d=b.slice(a._start,a._end||b.size);return d.name=b.name,d.ngfName=b.ngfName,a._chunkSize&&(c.append("_chunkSize",a._chunkSize),c.append("_currentChunkSize",a._end-a._start),c.append("_chunkNumber",Math.floor(a._start/a._chunkSize)),c.append("_totalSize",a._file.size)),d}return b}function h(b,e,f){if(void 0!==e)if(angular.isDate(e)&&(e=e.toISOString()),angular.isString(e))b.append(f,e);else if(d.isFile(e)){var g=c(e,b),i=f.split(",");i[1]&&(g.ngfName=i[1].replace(/^\s+|\s+$/g,""),f=i[0]),a._fileKey=a._fileKey||f,b.append(f,g,g.ngfName||g.name)}else if(angular.isObject(e)){if(e.$$ngfCircularDetection)throw"ngFileUpload: Circular reference in config.data. Make sure specified data for Upload.upload() has no circular reference: "+f;e.$$ngfCircularDetection=!0;try{for(var j in e)if(e.hasOwnProperty(j)&&"$$ngfCircularDetection"!==j){var k=null==a.objectKey?"[i]":a.objectKey;e.length&&parseInt(j)>-1&&(k=null==a.arrayKey?k:a.arrayKey),h(b,e[j],f+k.replace(/[ik]/g,j))}}finally{delete e.$$ngfCircularDetection}}else b.append(f,e)}function i(){a._chunkSize=d.translateScalars(a.resumeChunkSize),a._chunkSize=a._chunkSize?parseInt(a._chunkSize.toString()):null,a.headers=a.headers||{},a.headers["Content-Type"]=void 0,a.transformRequest=a.transformRequest?angular.isArray(a.transformRequest)?a.transformRequest:[a.transformRequest]:[],a.transformRequest.push(function(b){var d,c=new window.FormData;b=b||a.fields||{},a.file&&(b.file=a.file);for(d in b)if(b.hasOwnProperty(d)){var e=b[d];a.formDataAppender?a.formDataAppender(c,d,e):h(c,e,d)}return c})}return b||(a=g(a)),a._isDigested||(a._isDigested=!0,i()),f(a)},this.http=function(b){return b=g(b),b.transformRequest=b.transformRequest||function(b){return window.ArrayBuffer&&b instanceof window.ArrayBuffer||b instanceof window.Blob?b:a.defaults.transformRequest[0].apply(this,arguments)},b._chunkSize=d.translateScalars(b.resumeChunkSize),b._chunkSize=b._chunkSize?parseInt(b._chunkSize.toString()):null,f(b)},this.translateScalars=function(a){if(angular.isString(a)){if(a.search(/kb/i)===a.length-2)return parseFloat(1024*a.substring(0,a.length-2));if(a.search(/mb/i)===a.length-2)return parseFloat(1048576*a.substring(0,a.length-2));if(a.search(/gb/i)===a.length-2)return parseFloat(1073741824*a.substring(0,a.length-2));if(a.search(/b/i)===a.length-1)return parseFloat(a.substring(0,a.length-1));if(a.search(/s/i)===a.length-1)return parseFloat(a.substring(0,a.length-1));if(a.search(/m/i)===a.length-1)return parseFloat(60*a.substring(0,a.length-1));if(a.search(/h/i)===a.length-1)return parseFloat(3600*a.substring(0,a.length-1))}return a},this.urlToBlob=function(c){var d=b.defer();return a({url:c,method:"get",responseType:"arraybuffer"}).then(function(a){var b=new Uint8Array(a.data),c=a.headers("content-type")||"image/WebP",e=new window.Blob([b],{type:c});d.resolve(e)},function(a){d.reject(a)}),d.promise},this.setDefaults=function(a){this.defaults=a||{}},this.defaults={},this.version=ngFileUpload.version}]),ngFileUpload.service("Upload",["$parse","$timeout","$compile","$q","UploadExif",function(a,b,c,d,e){function g(a,b,c){var e=[f.emptyPromise()];return angular.forEach(a,function(d,g){0===d.type.indexOf("image/jpeg")&&f.attrGetter("ngfFixOrientation",b,c,{$file:d})&&e.push(f.happyPromise(f.applyExifRotation(d),d).then(function(b){a.splice(g,1,b)}))}),d.all(e)}function h(a,b,c){var e=f.attrGetter("ngfResize",b,c);if(!e||!f.isResizeSupported()||!a.length)return f.emptyPromise();if(!(e instanceof Function))return i(e,a,b,c);var g=d.defer();e(a).then(function(d){i(d,a,b,c).then(function(a){g.resolve(a)},function(a){g.reject(a)})},function(a){g.reject(a)})}function i(a,b,c,e){function h(d,h){if(0===d.type.indexOf("image")){if(a.pattern&&!f.validatePattern(d,a.pattern))return;var i=f.resize(d,a.width,a.height,a.quality,a.type,a.ratio,a.centerCrop,function(a,b){return f.attrGetter("ngfResizeIf",c,e,{$width:a,$height:b,$file:d})},a.restoreExif!==!1);g.push(i),i.then(function(a){b.splice(h,1,a)},function(a){d.$error="resize",d.$errorParam=(a?(a.message?a.message:a)+": ":"")+(d&&d.name)})}}for(var g=[f.emptyPromise()],i=0;i<b.length;i++)h(b[i],i);return d.all(g)}var f=e;return f.getAttrWithDefaults=function(a,b){if(null!=a[b])return a[b];var c=f.defaults[b];return null==c?c:angular.isString(c)?c:JSON.stringify(c)},f.attrGetter=function(b,c,d,e){var f=this.getAttrWithDefaults(c,b);if(!d)return f;try{return e?a(f)(d,e):a(f)(d)}catch(a){if(b.search(/min|max|pattern/i))return f;throw a}},f.shouldUpdateOn=function(a,b,c){var d=f.attrGetter("ngModelOptions",b,c);return!d||!d.updateOn||d.updateOn.split(" ").indexOf(a)>-1},f.emptyPromise=function(){var a=d.defer(),c=arguments;return b(function(){a.resolve.apply(a,c)}),a.promise},f.rejectPromise=function(){var a=d.defer(),c=arguments;return b(function(){a.reject.apply(a,c)}),a.promise},f.happyPromise=function(a,c){var e=d.defer();return a.then(function(a){e.resolve(a)},function(a){b(function(){throw a}),e.resolve(c)}),e.promise},f.updateModel=function(c,d,e,i,j,k,l){function m(g,h,j,l,m){d.$$ngfPrevValidFiles=g,d.$$ngfPrevInvalidFiles=h;var n=g&&g.length?g[0]:null,o=h&&h.length?h[0]:null;c&&(f.applyModelValidation(c,g),c.$setViewValue(m?n:g)),i&&a(i)(e,{$files:g,$file:n,$newFiles:j,$duplicateFiles:l,$invalidFiles:h,$invalidFile:o,$event:k});var p=f.attrGetter("ngfModelInvalid",d);p&&b(function(){a(p).assign(e,m?o:h)}),b(function(){})}function t(){function a(a,b){return a.name===b.name&&(a.$ngfOrigSize||a.size)===(b.$ngfOrigSize||b.size)&&a.type===b.type}function b(b){var c;for(c=0;c<p.length;c++)if(a(b,p[c]))return!0;for(c=0;c<q.length;c++)if(a(b,q[c]))return!0;return!1}if(j){n=[],o=[];for(var c=0;c<j.length;c++)b(j[c])?o.push(j[c]):n.push(j[c])}}function u(a){return angular.isArray(a)?a:[a]}function v(){s=[],r=[],angular.forEach(n,function(a){a.$error?r.push(a):s.push(a)})}function w(){function a(){b(function(){m(x?p.concat(s):s,x?q.concat(r):r,j,o,y)},A&&A.debounce?A.debounce.change||A.debounce:0)}h(z?n:s,d,e).then(function(){z?f.validate(n,p.length,c,d,e).then(function(){v(),a()}):a()},function(a){throw"Could not resize files "+a})}var n,p,q,o=[],r=[],s=[];p=d.$$ngfPrevValidFiles||[],q=d.$$ngfPrevInvalidFiles||[],c&&c.$modelValue&&(p=u(c.$modelValue));var x=f.attrGetter("ngfKeep",d,e);n=(j||[]).slice(0),"distinct"!==x&&f.attrGetter("ngfKeepDistinct",d,e)!==!0||t(d,e);var y=!x&&!f.attrGetter("ngfMultiple",d,e)&&!f.attrGetter("multiple",d);if(!x||n.length){f.attrGetter("ngfBeforeModelChange",d,e,{$files:j,$file:j&&j.length?j[0]:null,$newFiles:n,$duplicateFiles:o,$event:k});var z=f.attrGetter("ngfValidateAfterResize",d,e),A=f.attrGetter("ngModelOptions",d,e);f.validate(n,p.length,c,d,e).then(function(){l?m(n,[],j,o,y):(A&&A.allowInvalid||z?s=n:v(),f.attrGetter("ngfFixOrientation",d,e)&&f.isExifSupported()?g(s,d,e).then(function(){w()}):w())})}},f}]),ngFileUpload.directive("ngfSelect",["$parse","$timeout","$compile","Upload",function(a,b,c,d){function f(a){var b=a.match(/Android[^\d]*(\d+)\.(\d+)/);if(b&&b.length>2){var c=d.defaults.androidFixMinorVersion||4;return parseInt(b[1])<4||parseInt(b[1])===c&&parseInt(b[2])<c}return a.indexOf("Chrome")===-1&&/.*Windows.*Safari.*/.test(a)}function g(a,b,c,d,g,h,i,j){function l(){return"input"===b[0].tagName.toLowerCase()&&c.type&&"file"===c.type.toLowerCase()}function m(){return k("ngfChange")||k("ngfSelect")}function n(b){if(j.shouldUpdateOn("change",c,a)){for(var e=b.__files_||b.target&&b.target.files,f=[],g=0;g<e.length;g++)f.push(e[g]);j.updateModel(d,c,a,m(),f.length?f:null,b)}}function p(a){if(b!==a)for(var c=0;c<b[0].attributes.length;c++){var d=b[0].attributes[c];"type"!==d.name&&"class"!==d.name&&"style"!==d.name&&(null!=d.value&&""!==d.value||("required"===d.name&&(d.value="required"),"multiple"===d.name&&(d.value="multiple")),a.attr(d.name,"id"===d.name?"ngf-"+d.value:d.value))}}function q(){if(l())return b;var a=angular.element('<input type="file">');p(a);var c=angular.element("<label>upload</label>");return c.css("visibility","hidden").css("position","absolute").css("overflow","hidden").css("width","0px").css("height","0px").css("border","none").css("margin","0px").css("padding","0px").attr("tabindex","-1"),e.push({el:b,ref:c}),document.body.appendChild(c.append(a)[0]),a}function s(c){if(b.attr("disabled"))return!1;if(!k("ngfSelectDisabled",a)){var d=t(c);if(null!=d)return d;v(c);try{l()||document.body.contains(u[0])||(e.push({el:b,ref:u.parent()}),document.body.appendChild(u.parent()[0]),u.bind("change",n))}catch(a){}return f(navigator.userAgent)?setTimeout(function(){u[0].click()},0):u[0].click(),!1}}function t(a){var b=a.changedTouches||a.originalEvent&&a.originalEvent.changedTouches;if("touchstart"===a.type)return r=b?b[0].clientY:0,!0;if(a.stopPropagation(),a.preventDefault(),"touchend"===a.type){var c=b?b[0].clientY:0;if(Math.abs(c-r)>20)return!1}}function v(b){j.shouldUpdateOn("click",c,a)&&u.val()&&(u.val(null),j.updateModel(d,c,a,m(),null,b,!0))}function w(a){if(u&&!u.attr("__ngf_ie10_Fix_")){if(!u[0].parentNode)return void(u=null);a.preventDefault(),a.stopPropagation(),u.unbind("click");var b=u.clone();return u.replaceWith(b),u=b,u.attr("__ngf_ie10_Fix_","true"),u.bind("change",n),u.bind("click",w),u[0].click(),!1}u.removeAttr("__ngf_ie10_Fix_")}var k=function(a,b){return j.attrGetter(a,c,b)};j.registerModelChangeValidator(d,c,a);var o=[];o.push(a.$watch(k("ngfMultiple"),function(){u.attr("multiple",k("ngfMultiple",a))})),o.push(a.$watch(k("ngfCapture"),function(){u.attr("capture",k("ngfCapture",a))})),o.push(a.$watch(k("ngfAccept"),function(){u.attr("accept",k("ngfAccept",a))})),c.$observe("accept",function(){u.attr("accept",k("accept"))}),o.push(function(){c.$$observers&&delete c.$$observers.accept});var r=0,u=b;l()||(u=q()),u.bind("change",n),l()?b.bind("click",v):b.bind("click touchstart touchend",s),navigator.appVersion.indexOf("MSIE 10")!==-1&&u.bind("click",w),d&&d.$formatters.push(function(a){return null!=a&&0!==a.length||u.val()&&u.val(null),a}),a.$on("$destroy",function(){l()||u.parent().remove(),angular.forEach(o,function(a){a()})}),h(function(){for(var a=0;a<e.length;a++){var b=e[a];document.body.contains(b.el[0])||(e.splice(a,1),b.ref.remove())}}),window.FileAPI&&window.FileAPI.ngfFixIE&&window.FileAPI.ngfFixIE(b,u,n)}var e=[];return{restrict:"AEC",require:"?ngModel",link:function(e,f,h,i){g(e,f,h,i,a,b,c,d)}}}]),function(){function a(a){return"img"===a.tagName.toLowerCase()?"image":"audio"===a.tagName.toLowerCase()?"audio":"video"===a.tagName.toLowerCase()?"video":/./}function b(b,c,d,e,f,g,h,i){function j(a){var g=b.attrGetter("ngfNoObjectUrl",f,d);b.dataUrl(a,g).finally(function(){c(function(){var b=(g?a.$ngfDataUrl:a.$ngfBlobUrl)||a.$ngfDataUrl;i?e.css("background-image","url('"+(b||"")+"')"):e.attr("src",b),b?e.removeClass("ng-hide"):e.addClass("ng-hide")})})}c(function(){var c=d.$watch(f[g],function(c){var d=h;if("ngfThumbnail"===g&&(d||(d={width:e[0].clientWidth,height:e[0].clientHeight}),0===d.width&&window.getComputedStyle)){var f=getComputedStyle(e[0]);d={width:parseInt(f.width.slice(0,-2)),height:parseInt(f.height.slice(0,-2))}}return angular.isString(c)?(e.removeClass("ng-hide"),i?e.css("background-image","url('"+c+"')"):e.attr("src",c)):void(!c||!c.type||0!==c.type.search(a(e[0]))||i&&0!==c.type.indexOf("image")?e.addClass("ng-hide"):d&&b.isResizeSupported()?b.resize(c,d.width,d.height,d.quality).then(function(a){j(a)},function(a){throw a}):j(c))});d.$on("$destroy",function(){c()})})}ngFileUpload.service("UploadDataUrl",["UploadBase","$timeout","$q",function(a,b,c){var d=a;return d.base64DataUrl=function(a){if(angular.isArray(a)){var b=c.defer(),e=0;return angular.forEach(a,function(c){d.dataUrl(c,!0).finally(function(){if(e++,e===a.length){var c=[];angular.forEach(a,function(a){c.push(a.$ngfDataUrl)}),b.resolve(c,a)}})}),b.promise}return d.dataUrl(a,!0)},d.dataUrl=function(a,e){if(!a)return d.emptyPromise(a,a);if(e&&null!=a.$ngfDataUrl||!e&&null!=a.$ngfBlobUrl)return d.emptyPromise(e?a.$ngfDataUrl:a.$ngfBlobUrl,a);var f=e?a.$$ngfDataUrlPromise:a.$$ngfBlobUrlPromise;if(f)return f;var g=c.defer();return b(function(){if(window.FileReader&&a&&(!window.FileAPI||navigator.userAgent.indexOf("MSIE 8")===-1||a.size<2e4)&&(!window.FileAPI||navigator.userAgent.indexOf("MSIE 9")===-1||a.size<4e6)){var c=window.URL||window.webkitURL;if(c&&c.createObjectURL&&!e){var f;try{f=c.createObjectURL(a)}catch(c){return void b(function(){a.$ngfBlobUrl="",g.reject()})}b(function(){if(a.$ngfBlobUrl=f,f){g.resolve(f,a),d.blobUrls=d.blobUrls||[],d.blobUrlsTotalSize=d.blobUrlsTotalSize||0,d.blobUrls.push({url:f,size:a.size}),d.blobUrlsTotalSize+=a.size||0;for(var b=d.defaults.blobUrlsMaxMemory||268435456,e=d.defaults.blobUrlsMaxQueueSize||200;(d.blobUrlsTotalSize>b||d.blobUrls.length>e)&&d.blobUrls.length>1;){var h=d.blobUrls.splice(0,1)[0];c.revokeObjectURL(h.url),d.blobUrlsTotalSize-=h.size}}})}else{var h=new FileReader;h.onload=function(c){b(function(){a.$ngfDataUrl=c.target.result,g.resolve(c.target.result,a),b(function(){delete a.$ngfDataUrl},1e3)})},h.onerror=function(){b(function(){a.$ngfDataUrl="",g.reject()})},h.readAsDataURL(a)}}else b(function(){a[e?"$ngfDataUrl":"$ngfBlobUrl"]="",g.reject()})}),f=e?a.$$ngfDataUrlPromise=g.promise:a.$$ngfBlobUrlPromise=g.promise,f.finally(function(){delete a[e?"$$ngfDataUrlPromise":"$$ngfBlobUrlPromise"]}),f},d}]),ngFileUpload.directive("ngfSrc",["Upload","$timeout",function(a,c){return{restrict:"AE",link:function(d,e,f){b(a,c,d,e,f,"ngfSrc",a.attrGetter("ngfResize",f,d),!1)}}}]),ngFileUpload.directive("ngfBackground",["Upload","$timeout",function(a,c){return{restrict:"AE",link:function(d,e,f){b(a,c,d,e,f,"ngfBackground",a.attrGetter("ngfResize",f,d),!0)}}}]),ngFileUpload.directive("ngfThumbnail",["Upload","$timeout",function(a,c){return{restrict:"AE",link:function(d,e,f){var g=a.attrGetter("ngfSize",f,d);b(a,c,d,e,f,"ngfThumbnail",g,a.attrGetter("ngfAsBackground",f,d))}}}]),ngFileUpload.config(["$compileProvider",function(a){a.imgSrcSanitizationWhitelist&&a.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|local|file|data|blob):/),a.aHrefSanitizationWhitelist&&a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|local|file|data|blob):/)}]),ngFileUpload.filter("ngfDataUrl",["UploadDataUrl","$sce",function(a,b){return function(c,d,e){if(angular.isString(c))return b.trustAsResourceUrl(c);var f=c&&((d?c.$ngfDataUrl:c.$ngfBlobUrl)||c.$ngfDataUrl);return c&&!f?(!c.$ngfDataUrlFilterInProgress&&angular.isObject(c)&&(c.$ngfDataUrlFilterInProgress=!0,a.dataUrl(c,d)),""):(c&&delete c.$ngfDataUrlFilterInProgress,(c&&f?e?b.trustAsResourceUrl(f):f:c)||"")}}])}(),ngFileUpload.service("UploadValidate",["UploadDataUrl","$q","$timeout",function(a,b,c){function e(a){var b="",c=[];if(a.length>2&&"/"===a[0]&&"/"===a[a.length-1])b=a.substring(1,a.length-1);else{var d=a.split(",");if(d.length>1)for(var f=0;f<d.length;f++){var g=e(d[f]);g.regexp?(b+="("+g.regexp+")",f<d.length-1&&(b+="|")):c=c.concat(g.excludes)}else 0===a.indexOf("!")?c.push("^((?!"+e(a.substring(1)).regexp+").)*$"):(0===a.indexOf(".")&&(a="*"+a),b="^"+a.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",b=b.replace(/\\\*/g,".*").replace(/\\\?/g,"."))}return{regexp:b,excludes:c}}function f(a,b){null==b||a.$dirty||(a.$setDirty?a.$setDirty():a.$dirty=!0)}var d=a;return d.validatePattern=function(a,b){if(!b)return!0;var c=e(b),d=!0;if(c.regexp&&c.regexp.length){var f=new RegExp(c.regexp,"i");d=null!=a.type&&f.test(a.type)||null!=a.name&&f.test(a.name)}for(var g=c.excludes.length;g--;){var h=new RegExp(c.excludes[g],"i");d=d&&(null==a.type||h.test(a.type))&&(null==a.name||h.test(a.name))}return d},d.ratioToFloat=function(a){var b=a.toString(),c=b.search(/[x:]/i);return b=c>-1?parseFloat(b.substring(0,c))/parseFloat(b.substring(c+1)):parseFloat(b)},d.registerModelChangeValidator=function(a,b,c){a&&a.$formatters.push(function(e){a.$dirty&&(e&&!angular.isArray(e)&&(e=[e]),d.validate(e,0,a,b,c).then(function(){d.applyModelValidation(a,e)}))})},d.applyModelValidation=function(a,b){f(a,b),angular.forEach(a.$ngfValidations,function(b){a.$setValidity(b.name,b.valid)})},d.getValidationAttr=function(a,b,c,e,f){var g="ngf"+c[0].toUpperCase()+c.substr(1),h=d.attrGetter(g,a,b,{$file:f});if(null==h&&(h=d.attrGetter("ngfValidate",a,b,{$file:f}))){var i=(e||c).split(".");h=h[i[0]],i.length>1&&(h=h&&h[i[1]])}return h},d.validate=function(a,c,e,f,g){function i(b,c,h){if(a){for(var i=a.length,j=null;i--;){var k=a[i];if(k){var l=d.getValidationAttr(f,g,b,c,k);null!=l&&(h(k,l,i)||(k.$error=b,(k.$errorMessages=k.$errorMessages||{})[b]=!0,k.$errorParam=l,j=!1))}}null!==j&&e.$ngfValidations.push({name:b,valid:j})}}function k(c,i,j,k,l){function m(a,b,d){null!=d?k(b,d).then(function(e){l(e,d)?a.resolve():(b.$error=c,(b.$errorMessages=b.$errorMessages||{})[c]=!0,b.$errorParam=d,a.reject())},function(){h("ngfValidateForce",{$file:b})?(b.$error=c,(b.$errorMessages=b.$errorMessages||{})[c]=!0,b.$errorParam=d,a.reject()):a.resolve()}):a.resolve()}var n=[d.emptyPromise()];if(a)return a=void 0===a.length?[a]:a,angular.forEach(a,function(a){var e=b.defer();return n.push(e.promise),!j||null!=a.type&&0===a.type.search(j)?void("dimensions"===c&&null!=d.attrGetter("ngfDimensions",f)?d.imageDimensions(a).then(function(b){m(e,a,h("ngfDimensions",{$file:a,$width:b.width,$height:b.height}))},function(){e.reject()}):"duration"===c&&null!=d.attrGetter("ngfDuration",f)?d.mediaDuration(a).then(function(b){m(e,a,h("ngfDuration",{$file:a,$duration:b}))},function(){e.reject()}):m(e,a,d.getValidationAttr(f,g,c,i,a))):void e.resolve()}),b.all(n).then(function(){e.$ngfValidations.push({name:c,valid:!0})},function(){e.$ngfValidations.push({name:c,valid:!1})})}e=e||{},e.$ngfValidations=e.$ngfValidations||[],angular.forEach(e.$ngfValidations,function(a){a.valid=!0});var h=function(a,b){return d.attrGetter(a,f,g,b)};if(null==a||0===a.length)return d.emptyPromise(e);a=void 0===a.length?[a]:a.slice(0),i("maxFiles",null,function(a,b,d){return c+d<b}),i("pattern",null,d.validatePattern),i("minSize","size.min",function(a,b){return a.size+.1>=d.translateScalars(b)}),i("maxSize","size.max",function(a,b){return a.size-.1<=d.translateScalars(b)});var j=0;if(i("maxTotalSize",null,function(b,c){return j+=b.size,!(j>d.translateScalars(c))||(a.splice(0,a.length),!1)}),i("validateFn",null,function(a,b){return b===!0||null===b||""===b}),!a.length)return d.emptyPromise(e,e.$ngfValidations);var l=b.defer(),m=[];return m.push(d.happyPromise(k("maxHeight","height.max",/image/,this.imageDimensions,function(a,b){return a.height<=b}))),m.push(d.happyPromise(k("minHeight","height.min",/image/,this.imageDimensions,function(a,b){return a.height>=b}))),m.push(d.happyPromise(k("maxWidth","width.max",/image/,this.imageDimensions,function(a,b){return a.width<=b}))),m.push(d.happyPromise(k("minWidth","width.min",/image/,this.imageDimensions,function(a,b){return a.width>=b}))),m.push(d.happyPromise(k("dimensions",null,/image/,function(a,b){return d.emptyPromise(b)},function(a){return a}))),m.push(d.happyPromise(k("ratio",null,/image/,this.imageDimensions,function(a,b){for(var c=b.toString().split(","),e=!1,f=0;f<c.length;f++)Math.abs(a.width/a.height-d.ratioToFloat(c[f]))<1e-4&&(e=!0);return e}))),m.push(d.happyPromise(k("maxRatio","ratio.max",/image/,this.imageDimensions,function(a,b){return a.width/a.height-d.ratioToFloat(b)<1e-4}))),m.push(d.happyPromise(k("minRatio","ratio.min",/image/,this.imageDimensions,function(a,b){return a.width/a.height-d.ratioToFloat(b)>-1e-4}))),m.push(d.happyPromise(k("maxDuration","duration.max",/audio|video/,this.mediaDuration,function(a,b){return a<=d.translateScalars(b)}))),m.push(d.happyPromise(k("minDuration","duration.min",/audio|video/,this.mediaDuration,function(a,b){return a>=d.translateScalars(b)}))),m.push(d.happyPromise(k("duration",null,/audio|video/,function(a,b){return d.emptyPromise(b)},function(a){return a}))),m.push(d.happyPromise(k("validateAsyncFn",null,null,function(a,b){return b},function(a){return a===!0||null===a||""===a}))),b.all(m).then(function(){l.resolve(e,e.$ngfValidations)})},d.imageDimensions=function(a){if(a.$ngfWidth&&a.$ngfHeight){var e=b.defer();return c(function(){e.resolve({width:a.$ngfWidth,height:a.$ngfHeight})}),e.promise}if(a.$ngfDimensionPromise)return a.$ngfDimensionPromise;var f=b.defer();return c(function(){return 0!==a.type.indexOf("image")?void f.reject("not image"):void d.dataUrl(a).then(function(b){function e(){var b=d[0].clientWidth,c=d[0].clientHeight;d.remove(),a.$ngfWidth=b,a.$ngfHeight=c,f.resolve({width:b,height:c})}function g(){d.remove(),f.reject("load error")}function i(){c(function(){d[0].parentNode&&(d[0].clientWidth?e():h>10?g():i())},1e3)}var d=angular.element("<img>").attr("src",b).css("visibility","hidden").css("position","fixed").css("max-width","none !important").css("max-height","none !important");d.on("load",e),d.on("error",g);var h=0;i(),angular.element(document.getElementsByTagName("body")[0]).append(d)},function(){f.reject("load error")})}),a.$ngfDimensionPromise=f.promise,a.$ngfDimensionPromise.finally(function(){delete a.$ngfDimensionPromise}),a.$ngfDimensionPromise},d.mediaDuration=function(a){if(a.$ngfDuration){var e=b.defer();return c(function(){e.resolve(a.$ngfDuration)}),e.promise}if(a.$ngfDurationPromise)return a.$ngfDurationPromise;var f=b.defer();return c(function(){return 0!==a.type.indexOf("audio")&&0!==a.type.indexOf("video")?void f.reject("not media"):void d.dataUrl(a).then(function(b){function e(){var b=d[0].duration;a.$ngfDuration=b,d.remove(),f.resolve(b)}function g(){d.remove(),f.reject("load error")}function i(){c(function(){d[0].parentNode&&(d[0].duration?e():h>10?g():i())},1e3)}var d=angular.element(0===a.type.indexOf("audio")?"<audio>":"<video>").attr("src",b).css("visibility","none").css("position","fixed");d.on("loadedmetadata",e),d.on("error",g);var h=0;i(),angular.element(document.body).append(d)},function(){f.reject("load error")})}),a.$ngfDurationPromise=f.promise,a.$ngfDurationPromise.finally(function(){delete a.$ngfDurationPromise}),a.$ngfDurationPromise},d}]),ngFileUpload.service("UploadResize",["UploadValidate","$q",function(a,b){var c=a,d=function(a,b,c,d,e){var f=e?Math.max(c/a,d/b):Math.min(c/a,d/b);return{width:a*f,height:b*f,marginX:a*f-c,marginY:b*f-d}},e=function(a,e,f,g,h,i,j,k){var l=b.defer(),m=document.createElement("canvas"),n=document.createElement("img");return n.onload=function(){if(null!=k&&k(n.width,n.height)===!1)return void l.reject("resizeIf");try{if(i){var a=c.ratioToFloat(i),b=n.width/n.height;b<a?(e=n.width,f=e/a):(f=n.height,e=f*a)}e||(e=n.width),f||(f=n.height);var o=d(n.width,n.height,e,f,j);m.width=Math.min(o.width,e),m.height=Math.min(o.height,f);var p=m.getContext("2d");p.drawImage(n,Math.min(0,-o.marginX/2),Math.min(0,-o.marginY/2),o.width,o.height),l.resolve(m.toDataURL(h||"image/WebP",g||.934))}catch(a){l.reject(a)}},n.onerror=function(){l.reject()},n.src=a,l.promise};return c.dataUrltoBlob=function(a,b,c){for(var d=a.split(","),e=d[0].match(/:(.*?);/)[1],f=atob(d[1]),g=f.length,h=new Uint8Array(g);g--;)h[g]=f.charCodeAt(g);var i=new window.Blob([h],{type:e});return i.name=b,i.$ngfOrigSize=c,i},c.isResizeSupported=function(){var a=document.createElement("canvas");return window.atob&&a.getContext&&a.getContext("2d")&&window.Blob},c.isResizeSupported()&&Object.defineProperty(window.Blob.prototype,"name",{get:function(){return this.$ngfName},set:function(a){this.$ngfName=a},configurable:!0}),c.resize=function(a,d,f,g,h,i,j,k,l){if(0!==a.type.indexOf("image"))return c.emptyPromise(a);var m=b.defer();return c.dataUrl(a,!0).then(function(b){e(b,d,f,g,h||a.type,i,j,k).then(function(d){if("image/jpeg"===a.type&&l)try{d=c.restoreExif(b,d)}catch(a){setTimeout(function(){throw a},1)}try{var e=c.dataUrltoBlob(d,a.name,a.size);m.resolve(e)}catch(a){m.reject(a)}},function(b){"resizeIf"===b&&m.resolve(a),m.reject(b)})},function(a){m.reject(a)}),m.promise},c}]),function(){function a(a,c,d,e,f,g,h,i,j,k){function n(){return c.attr("disabled")||m("ngfDropDisabled",a)}function s(b,c){i.updateModel(e,d,a,m("ngfChange")||m("ngfDrop"),b,c)}function t(b,c){if(!i.shouldUpdateOn(b,d,a)||!c)return i.rejectPromise([]);var e=[];c.replace(/<(img src|img [^>]* src) *=\"([^\"]*)\"/gi,function(a,b,c){e.push(c)});var f=[],g=[];if(e.length){angular.forEach(e,function(a){f.push(i.urlToBlob(a).then(function(a){g.push(a)}))});var h=k.defer();return k.all(f).then(function(){h.resolve(g)},function(a){h.reject(a)}),h.promise}return i.emptyPromise()}function u(a,b,c,d){var e=m("ngfDragOverClass",a,{$event:c}),f="dragover";if(angular.isString(e))f=e;else if(e&&(e.delay&&(q=e.delay),e.accept||e.reject)){var g=c.dataTransfer.items;if(null!=g&&g.length)for(var h=e.pattern||m("ngfPattern",a,{$event:c}),j=g.length;j--;){if(!i.validatePattern(g[j],h)){f=e.reject;break}f=e.accept}else f=e.accept}d(f)}function v(b,c,e,f){function p(a,b){var c=k.defer();if(null!=a)if(a.isDirectory){var d=[i.emptyPromise()];if(l){var e={type:"directory"};e.name=e.path=(b||"")+a.name+a.name,n.push(e)}var f=a.createReader(),h=[],m=function(){f.readEntries(function(e){try{e.length?(h=h.concat(Array.prototype.slice.call(e||[],0)),m()):(angular.forEach(h.slice(0),function(c){n.length<=g&&o<=j&&d.push(p(c,(b?b:"")+a.name+"/"))}),k.all(d).then(function(){c.resolve()},function(a){c.reject(a)}))}catch(a){c.reject(a)}},function(a){c.reject(a)})};m()}else a.file(function(a){try{a.path=(b?b:"")+a.name,l&&(a=i.rename(a,a.path)),n.push(a),o+=a.size,c.resolve()}catch(a){c.reject(a)}},function(a){c.reject(a)});return c.promise}var g=i.getValidationAttr(d,a,"maxFiles")||Number.MAX_VALUE,j=i.getValidationAttr(d,a,"maxTotalSize")||Number.MAX_VALUE,l=m("ngfIncludeDir",a),n=[],o=0,q=[i.emptyPromise()];if(b&&b.length>0&&"file"!==h.protocol())for(var r=0;r<b.length;r++){if(b[r].webkitGetAsEntry&&b[r].webkitGetAsEntry()&&b[r].webkitGetAsEntry().isDirectory){var s=b[r].webkitGetAsEntry();if(s.isDirectory&&!e)continue;null!=s&&q.push(p(s))}else{var t=b[r].getAsFile();null!=t&&(n.push(t),o+=t.size)}if(n.length>g||o>j||!f&&n.length>0)break}else if(null!=c)for(var u=0;u<c.length;u++){var v=c.item(u);if((v.type||v.size>0)&&(n.push(v),o+=v.size),n.length>g||o>j||!f&&n.length>0)break}var w=k.defer();return k.all(q).then(function(){if(f||l||!n.length)w.resolve(n);else{for(var a=0;n[a]&&"directory"===n[a].type;)a++;w.resolve([n[a]])}},function(a){w.reject(a)}),w.promise}var l=b(),m=function(a,b,c){return i.attrGetter(a,d,b,c)};if(m("dropAvailable")&&g(function(){a[m("dropAvailable")]?a[m("dropAvailable")].value=l:a[m("dropAvailable")]=l}),!l)return void(m("ngfHideOnDropNotAvailable",a)===!0&&c.css("display","none"));null==m("ngfSelect")&&i.registerModelChangeValidator(e,d,a);var r,o=null,p=f(m("ngfStopPropagation")),q=1;c[0].addEventListener("dragover",function(b){if(!n()&&i.shouldUpdateOn("drop",d,a)){if(b.preventDefault(),p(a)&&b.stopPropagation(),navigator.userAgent.indexOf("Chrome")>-1){var e=b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect="move"===e||"linkMove"===e?"move":"copy"}g.cancel(o),r||(r="C",u(a,d,b,function(d){r=d,c.addClass(r),m("ngfDrag",a,{$isDragging:!0,$class:r,$event:b})}))}},!1),c[0].addEventListener("dragenter",function(b){!n()&&i.shouldUpdateOn("drop",d,a)&&(b.preventDefault(),p(a)&&b.stopPropagation())},!1),c[0].addEventListener("dragleave",function(b){!n()&&i.shouldUpdateOn("drop",d,a)&&(b.preventDefault(),p(a)&&b.stopPropagation(),o=g(function(){r&&c.removeClass(r),r=null,m("ngfDrag",a,{$isDragging:!1,$event:b})},q||100))},!1),c[0].addEventListener("drop",function(b){if(!n()&&i.shouldUpdateOn("drop",d,a)){b.preventDefault(),p(a)&&b.stopPropagation(),r&&c.removeClass(r),r=null;var f,e=b.dataTransfer.items;try{f=b.dataTransfer&&b.dataTransfer.getData&&b.dataTransfer.getData("text/html")}catch(a){}v(e,b.dataTransfer.files,m("ngfAllowDir",a)!==!1,m("multiple")||m("ngfMultiple",a)).then(function(a){a.length?s(a,b):t("dropUrl",f).then(function(a){s(a,b)})})}},!1),c[0].addEventListener("paste",function(b){if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&m("ngfEnableFirefoxPaste",a)&&b.preventDefault(),!n()&&i.shouldUpdateOn("paste",d,a)){var c=[],e=b.clipboardData||b.originalEvent.clipboardData;if(e&&e.items)for(var f=0;f<e.items.length;f++)e.items[f].type.indexOf("image")!==-1&&c.push(e.items[f].getAsFile());c.length?s(c,b):t("pasteUrl",e).then(function(a){s(a,b)})}},!1),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&m("ngfEnableFirefoxPaste",a)&&(c.attr("contenteditable",!0),c.on("keypress",function(a){a.metaKey||a.ctrlKey||a.preventDefault()}))}function b(){var a=document.createElement("div");return"draggable"in a&&"ondrop"in a&&!/Edge\/12./i.test(navigator.userAgent)}ngFileUpload.directive("ngfDrop",["$parse","$timeout","$location","Upload","$http","$q",function(b,c,d,e,f,g){return{restrict:"AEC",
require:"?ngModel",link:function(h,i,j,k){a(h,i,j,k,b,c,d,e,f,g)}}}]),ngFileUpload.directive("ngfNoFileDrop",function(){return function(a,c){b()&&c.css("display","none")}}),ngFileUpload.directive("ngfDropAvailable",["$parse","$timeout","Upload",function(a,c,d){return function(e,f,g){if(b()){var h=a(d.attrGetter("ngfDropAvailable",g));c(function(){h(e),h.assign&&h.assign(e,!0)})}}}])}(),ngFileUpload.service("UploadExif",["UploadResize","$q",function(a,b){function d(a,b,c,d){switch(b){case 2:return a.transform(-1,0,0,1,c,0);case 3:return a.transform(-1,0,0,-1,c,d);case 4:return a.transform(1,0,0,-1,0,d);case 5:return a.transform(0,1,1,0,0,0);case 6:return a.transform(0,1,-1,0,d,0);case 7:return a.transform(0,-1,-1,0,d,c);case 8:return a.transform(0,-1,1,0,0,c)}}function e(a){for(var b="",c=new Uint8Array(a),d=c.byteLength,e=0;e<d;e++)b+=String.fromCharCode(c[e]);return window.btoa(b)}var c=a;return c.isExifSupported=function(){return window.FileReader&&(new FileReader).readAsArrayBuffer&&c.isResizeSupported()},c.readOrientation=function(a){var c=b.defer(),d=new FileReader,e=a.slice?a.slice(0,65536):a;return d.readAsArrayBuffer(e),d.onerror=function(a){return c.reject(a)},d.onload=function(a){var b={orientation:1},d=new DataView(this.result);if(65496!==d.getUint16(0,!1))return c.resolve(b);for(var e=d.byteLength,f=2;f<e;){var g=d.getUint16(f,!1);if(f+=2,65505===g){if(1165519206!==d.getUint32(f+=2,!1))return c.resolve(b);var h=18761===d.getUint16(f+=6,!1);f+=d.getUint32(f+4,h);var i=d.getUint16(f,h);f+=2;for(var j=0;j<i;j++)if(274===d.getUint16(f+12*j,h)){var k=d.getUint16(f+12*j+8,h);return k>=2&&k<=8&&(d.setUint16(f+12*j+8,1,h),b.fixedArrayBuffer=a.target.result),b.orientation=k,c.resolve(b)}}else{if(65280!==(65280&g))break;f+=d.getUint16(f,!1)}}return c.resolve(b)},c.promise},c.applyExifRotation=function(a){if(0!==a.type.indexOf("image/jpeg"))return c.emptyPromise(a);var f=b.defer();return c.readOrientation(a).then(function(b){return b.orientation<2||b.orientation>8?f.resolve(a):void c.dataUrl(a,!0).then(function(g){var h=document.createElement("canvas"),i=document.createElement("img");i.onload=function(){try{h.width=b.orientation>4?i.height:i.width,h.height=b.orientation>4?i.width:i.height;var g=h.getContext("2d");d(g,b.orientation,i.width,i.height),g.drawImage(i,0,0);var j=h.toDataURL(a.type||"image/WebP",.934);j=c.restoreExif(e(b.fixedArrayBuffer),j);var k=c.dataUrltoBlob(j,a.name);f.resolve(k)}catch(a){return f.reject(a)}},i.onerror=function(){f.reject()},i.src=g},function(a){f.reject(a)})},function(a){f.reject(a)}),f.promise},c.restoreExif=function(a,b){var c={};return c.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c.encode64=function(a){var c,d,f,g,h,b="",e="",i="",j=0;do c=a[j++],d=a[j++],e=a[j++],f=c>>2,g=(3&c)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),b=b+this.KEY_STR.charAt(f)+this.KEY_STR.charAt(g)+this.KEY_STR.charAt(h)+this.KEY_STR.charAt(i),c=d=e="",f=g=h=i="";while(j<a.length);return b},c.restore=function(a,b){a.match("data:image/jpeg;base64,")&&(a=a.replace("data:image/jpeg;base64,",""));var c=this.decode64(a),d=this.slice2Segments(c),e=this.exifManipulation(b,d);return"data:image/jpeg;base64,"+this.encode64(e)},c.exifManipulation=function(a,b){var c=this.getExifArray(b),d=this.insertExif(a,c);return new Uint8Array(d)},c.getExifArray=function(a){for(var b,c=0;c<a.length;c++)if(b=a[c],255===b[0]&225===b[1])return b;return[]},c.insertExif=function(a,b){var c=a.replace("data:image/jpeg;base64,",""),d=this.decode64(c),e=d.indexOf(255,3),f=d.slice(0,e),g=d.slice(e),h=f;return h=h.concat(b),h=h.concat(g)},c.slice2Segments=function(a){for(var b=0,c=[];;){if(255===a[b]&218===a[b+1])break;if(255===a[b]&216===a[b+1])b+=2;else{var d=256*a[b+2]+a[b+3],e=b+d+2,f=a.slice(b,e);c.push(f),b=e}if(b>a.length)break}return c},c.decode64=function(a){var b,c,e,f,g,d="",h="",i=0,j=[],k=/[^A-Za-z0-9\+\/\=]/g;k.exec(a)&&console.log("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, NaNExpect errors in decoding."),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do e=this.KEY_STR.indexOf(a.charAt(i++)),f=this.KEY_STR.indexOf(a.charAt(i++)),g=this.KEY_STR.indexOf(a.charAt(i++)),h=this.KEY_STR.indexOf(a.charAt(i++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,j.push(b),64!==g&&j.push(c),64!==h&&j.push(d),b=c=d="",e=f=g=h="";while(i<a.length);return j},c.restore(a,b)},c}]);